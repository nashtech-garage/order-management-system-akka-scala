<div class="payment-form-container">
  <div class="header">
    <h1>Create Payment</h1>
  </div>

  @if (error()) {
    <div class="error">{{ error() }}</div>
  }

  <form [formGroup]="paymentForm" (ngSubmit)="onSubmit()">
    <div class="form-group">
      <label for="orderId">Order *</label>
      <select
        id="orderId"
        formControlName="orderId"
        (change)="onOrderChange($event)"
        [class.invalid]="isFieldInvalid('orderId')"
      >
        <option value="">Select an order</option>
        @for (order of orders(); track order.id) {
          <option [value]="order.id">
            Order #{{ order.id }} - {{ order.customerName }} - ${{ order.totalAmount }}
          </option>
        }
      </select>
      @if (isFieldInvalid('orderId')) {
        <span class="error-message">{{ getFieldError('orderId') }}</span>
      }
    </div>

    <div class="form-group">
      <label for="amount">Amount *</label>
      <input
        type="number"
        id="amount"
        formControlName="amount"
        step="0.01"
        min="0.01"
        placeholder="Enter amount"
        [class.invalid]="isFieldInvalid('amount')"
      />
      @if (isFieldInvalid('amount')) {
        <span class="error-message">{{ getFieldError('amount') }}</span>
      }
    </div>

    <div class="form-group">
      <label for="paymentMethod">Payment Method *</label>
      <select
        id="paymentMethod"
        formControlName="paymentMethod"
        [class.invalid]="isFieldInvalid('paymentMethod')"
      >
        @for (method of paymentMethods; track method.value) {
          <option [value]="method.value">{{ method.label }}</option>
        }
      </select>
      @if (isFieldInvalid('paymentMethod')) {
        <span class="error-message">{{ getFieldError('paymentMethod') }}</span>
      }
    </div>

    <div class="form-actions">
      <button type="button" class="btn btn-secondary" (click)="cancel()" [disabled]="loading()">
        Cancel
      </button>
      <button type="submit" class="btn btn-primary" [disabled]="loading()">
        {{ loading() ? 'Creating...' : 'Create Payment' }}
      </button>
    </div>
  </form>
</div>
